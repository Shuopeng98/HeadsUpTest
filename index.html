<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">

  <title>合家欢游戏-你划我猜</title>

  <!--http://www.html5rocks.com/en/mobile/mobifying/-->
  <meta name="viewport"
        content="width=device-width,user-scalable=no,initial-scale=1, minimum-scale=1,maximum-scale=1"/>

  <!--https://developer.apple.com/library/safari/documentation/AppleApplications/Reference/SafariHTMLRef/Articles/MetaTags.html-->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="format-detection" content="telephone=no">

  <!-- force webkit on 360 -->
  <meta name="renderer" content="webkit"/>
  <meta name="force-rendering" content="webkit"/>
  <!-- force edge on IE -->
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
  <meta name="msapplication-tap-highlight" content="no">

  <!-- force full screen on some browser -->
  <meta name="full-screen" content="yes"/>
  <meta name="x5-fullscreen" content="true"/>
  <meta name="360-fullscreen" content="true"/>
  
  <!-- force screen orientation on some browser -->
  <meta name="screen-orientation" content="portrait"/>
  <meta name="x5-orientation" content="portrait">

  <!--fix fireball/issues/3568 -->
  <!--<meta name="browsermode" content="application">-->
  <meta name="x5-page-mode" content="app">

  <!--<link rel="apple-touch-icon" href=".png" />-->
  <!--<link rel="apple-touch-icon-precomposed" href=".png" />-->

  <link rel="stylesheet" type="text/css" href="style-mobile.6e9cd.css"/>
  <link rel="icon" href="favicon.8de18.ico"/>
</head>
<body>
  <canvas id="GameCanvas" oncontextmenu="event.preventDefault()" tabindex="0"></canvas>
  <div id="splash">
    <div class="progress-bar stripes">
      <span style="width: 0%"></span>
    </div>
  </div>

<script src="src/settings.9eda7.js" charset="utf-8"></script>

<script src="main.aef43.js" charset="utf-8"></script>

<script type="text/javascript">
(function () {
    // open web debugger console
    if (typeof VConsole !== 'undefined') {
        window.vConsole = new VConsole();
    }

    var debug = window._CCSettings.debug;
    var splash = document.getElementById('splash');
    splash.style.display = 'block';

    function loadScript (moduleName, cb) {
      function scriptLoaded () {
          document.body.removeChild(domScript);
          domScript.removeEventListener('load', scriptLoaded, false);
          cb && cb();
      };
      var domScript = document.createElement('script');
      domScript.async = true;
      domScript.src = moduleName;
      domScript.addEventListener('load', scriptLoaded, false);
      document.body.appendChild(domScript);
    }

    loadScript(debug ? 'cocos2d-js.js' : 'cocos2d-js-min.7c81f.js', function () {
      if (CC_PHYSICS_BUILTIN || CC_PHYSICS_CANNON) {
        loadScript(debug ? 'physics.js' : 'physics-min.js', window.boot);
      }
      else {
        window.boot();
      }
    });
})();
   // 登录
    /**
     * 删除url某参数
     * @param url
     * @param parameter
     * @returns {*}
     * @constructor
     */
     function RemoveParameterFromUrl(url, parameters = []) {
        parameters.forEach((item) => {
            url = url.replace(new RegExp(`\\b${item}=[^&;]+[&;]?`, 'gi'), '', '$1');

            // remove any leftover crud
            url = url.replace(/[&;]$/, '');
        });

        return url;
    }
    /**
     * 获取cookie
     * @param name 要获取的cookie的名称
     * @returns {*}
     */
    function getCookie(name) {
        let arr;
        const reg = new RegExp(`(^| )${name}=([^;]*)(;|$)`);
        if (arr = document.cookie.match(reg)) {
            return decodeURIComponent(arr[2]);
        }
        return '';
    }
    /**
     * 设置cookie
     * @param name cookie名称
     * @param value cookie值
     * @param second 过期时间，默认1800
     * @param domain 域名，默认qq.com
     */
    function setCookie(name, value, second = 1800, domain = 'qq.com') {
        const exp = new Date();
        exp.setTime(exp.getTime() + (second * 1000));
        document.cookie = `${name}=${encodeURIComponent(value)};domain=.${domain};path=/;expires=${exp.toGMTString()}`;
    }
    function doLogin(param) {
        var url = '';
        var href = param || location.href;
        href = RemoveParameterFromUrl(href, ['sessionid', 'channelid']);
        var curHost = window.location.host;
        var isUseProductionConfig = curHost === 'jiazhang.qq.com' || curHost === 'pre.jiazhang.qq.com';
        var BASE_HOST = isUseProductionConfig ? (curHost === 'pre.jiazhang.qq.com' ? '//pre.jz.game.qq.com' : '//jz.game.qq.com') : '//test.jz.game.qq.com';
        // 新登录
        var channelId = 2;
        var WX_APP_ID = 'wxeaef343b1641dda3';
        var redirectUri = encodeURIComponent(`https:${BASE_HOST
        }/cgi-bin/Gateway.fcgi?method=wLogin&channelId=${
            channelId
        }&localParams=${window.btoa(`redirectUrl=${encodeURIComponent(href)}`)}`);
        // 微信环境下登录
        url = `https://open.weixin.qq.com/connect/oauth2/authorize?appid=${
            WX_APP_ID
        }&redirect_uri=${redirectUri
        }&response_type=code&scope=snsapi_userinfo&state=STATE&connect_redirect=1#wechat_redirect`;
        var expire = new Date().getTime() + 60 * 60 * 1000;
        setCookie("expire",expire);
        location.replace(url);
    }
    function isLogin() {
        var expire = getCookie("expire");
        var now = new Date().getTime();
        var session_id = getCookie('session_id');
        var channel_id = getCookie('channel_id');
        if( session_id && channel_id && session_id.length > 10 && ( expire &&  now < expire ) ){
            return true;
        }else{
            return false;
        }
    }
    var hasLogin = isLogin();
    if( !hasLogin ){
        doLogin();
    }
</script>
</body>
</html>
